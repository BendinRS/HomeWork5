# -*- mode: ruby -*-
# vim: set ft=ruby :

Vagrant.configure("2") do |config|
  config.vm.define "server" do |server|
  server.vm.box = "Centos/7"
  server.communicator = "ssh"
  server.vm.ignore_box_vagrantfile = true
  server.vm.hostname = "server"
  server.vm.network "private_network". ip: "192.168.31.122", netmask "24", virtual_box_intnet: "mynetwork"
  server.vm.provider "virtualbox" do |vb|
    vb.cpus = 1
    vb.gui = true
    vb.memory = "512"
  end
  server.vm.provision "shell", incline: <<-SCRIPT
  systemctl start nfs-server
  systemctl start rpcbind
  mkdir /var/upload
  chmod o+rw /var/upload
  echo "/var/upload *(rw)" >> /etc/exports
  exportfs -a
  systemctl restart nfs-server
  touch file111 /var/upload/
    SCRIPT
end
config.vm.define "client" do |client|
  client.vm.box = "Centos/7"
  client.communicator = "ssh"
  client.vm.ignore_box_vagrantfile = true
  client.vm.hostname = "client"
  client.vm.network "private_network". ip: "192.168.31.123", netmask "24", virtual_box_intnet: "mynetwork"
  client.vm.network "forwarded_port", guest: 22, host: 2200
  client.vm.provider "virtualbox" do |vb1|
      vb1.cpus = 1
      vb1.gui = true
      vb1.memory = "512"
  end
  client.vm.provision "shell", incline: <<-SCRIPT
    mkdir /mnt/upload
    mount -t nfs 192.168.1.1:/var/upload /mnt/upload
    SCRIPT
end

  
    
  end
